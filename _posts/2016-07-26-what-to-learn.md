---
title: '一个OS人的漫谈'
date: 2016-07-26
---

聊聊我对于在国内从事操作系统工作的一点看法。

## 在中国搞操作系统

中国互联网蒸蒸日上的同时，计算机系统软件行业——更窄一点，操作系统——在中国的发展却显得没有那么耀眼。
中国最大的几家IT企业，比如百度、腾讯、阿里巴巴等，都以互联网业务为主，并不会投入太多的人力物力到底层软件的开发与研究中。
国家倒是很重视，常常喊着要大力开发“国产自有操作系统”，但往往是大把钱撒出去，弄出一些糊弄人的玩意，真正能用的少得可怜。

从个人的角度来说，当你浏览各大招聘网站的IT/软件板块时，也确实很难觅到“操作系统工程师”、“底层软件工程师”这样的岗位，
即使有，一般也来自Intel、微软、VMware等外企，并且相对于“前端工程师”这种岗位来说实在是少得可怜。

有人可能会疑惑，操作系统是每个计算机学生的必修课，绝大多数高校的计算机系都有操作系统的讲师，
甚至从事这一研究方向的专家教授，这些老师又会培养诸多操作系统方向的研究生、博士生，
这些学生毕业之后去哪里了呢？
既然国内真正对口的就业岗位就那么多，其去向可能有以下几种：去外企、转互联网/上层软件开发、出国深造。
据我观察，还是转互联网的居多。

此外你要知道，操作系统老师多不意味着就一定能培养出大量的合格的操作系统工程师。
我觉得一方面是OS方向的学生们身在曹营心在汉，毕竟互联网企业的薪水摆在那里，
念着OS的硕博但心里更多地盘算着就业季怎么通过BAT的校招面试。

另一方面（更加重要），是受制于我国在系统软件方面的学术科研水平。
操作系统的顶级的研究成果一般发表于两个会议：SOSP和OSDI。
前者奇数年召开，后者偶数年。
其中SOSP第一届的召开可以追溯到1967年——没错，比UNIX的年纪还要大。
截止到2015年，SOSP已经召开了25届，每届会议大概会收录20-30篇论文。
加上从1994年开始的OSDI，两个会议的大概700-800篇论文汇集了人类在计算机操作系统
（包含内核、安全、网络、性能优化、文件系统、形式化等多个子方向）的精华成果。
那么中国的科学家们在其中的贡献如何呢？
答案是少得可怜。
想象一下，1967年第一届SOSP召开，MULTICS设计者提出进程的概念的时候，
国内才刚开始进行一项轰轰烈烈的阶级运动。
如今，50年快要过去了，虽然我国的系统软件方面的科研水平有了十足长进，以清华和上海交大为代表的科研团队已经数次投中两大顶会的论文。
但这不能掩饰我国系统软件科研水平总体上相对于美国还是有一个很大幅度的落后的现实。

听上去，在国内搞操作系统是挺没劲的，学术研究水平不高，就业市场也不宽阔。
然而，这两点看似是弱项，其实更是机遇。
首先，就业岗位虽然少，但候选人更少。
由于互联网太火，大量的IT精英们涌向BAT和创业公司挣大钱，
OS开发岗位往往是人才难觅。
一个应届硕士生想要在BAT拿到special的offer，
除了出身的要求（例如本硕皆985），
还需要拿得出手的成果，例如ACM竞赛获奖、出色的软件作品、top期刊或会议的论文，或者很牛的公司（如google）的实习经历等。
然而操作系统岗位就不一样了，
面试官既不指望你发表过OSDI或SOSP，更不指望你写出过一个开源的操作系统，
只要候选人对OS的相关概念有一定理解，并从事过相关工作（哪怕是边缘一点的，比如软件包管理器的开发），
对于OS开发岗位可能都是合格的人选，
如果你又有些许闪光点的话（比如口才很好），也许拿到special级别的offer就是探囊取物了。
从这个角度来看，实际上国内OS开发岗位的竞争明显要小得多。

其次，国内研究水平低，意味着对人才、技术的渴望更加强烈。
研究水平低的原因不在于你，而在于历史因素，没有人会因为这个看不起你。
而当你取得了一定的成果，则更容易在国内的大环境下脱颖而出，获得更多的资源和声誉。
例如陈莉君对于国内的Linux推广做出较大贡献，有诸多著作和译注，
可谓Linux在国内的先驱人。
上海交大的陈海波教授带领其OS团队在国际大会上多有斩获，也可谓国内在OS方向的科研领军人物。
在陈的推动下，SOSP将在今年于上海召开，这是SOSP首次走进中国，陈担任会议主席。
这对陈来说是一个巨大的肯定和支持，其本人也已经被华为高薪挖走。
想象一下，如果陈在美国，研究成果高过他的自然大有人在，他也不太可能成为SOSP的主席。
此外，淘宝的章文嵩出于对Linux中的LVS的贡献，也是国内公认的操作系统方面的专家，
现也被滴滴挖走，主持滴滴的基础平台建设工作。
这样的人物不胜枚举。

最后，做的人少意味着圈子很小，这实际上也给职业生涯的发展带来了一点优势。
在Linkedin上，可能你通过2~3个connections就能在你的人际关系网中找到像陈海波、章文嵩这样的大牛。
这意味着你更容易认识这个圈子中的大牛，更不容易错过重要的活动（例如SOSP 2017），
更容易了解、接纳技术的更新和新产品的问世。
这些对于一个工程师的职业发展有着重要的意义。

总之，至少在我看来，在国内搞OS并不是一件坏事。

## 成为一个合格的OS人

下面聊聊做OS的技能点有哪些，我觉得一个OS人的养成可以分为两个阶段。

- 计算机基础知识
- 操作系统和虚拟化领域的专业知识与技术

### 基础

基础阶段可以认为是计算机科学专业的本科课程的学习，包括程序设计语言、数据结构、网络、数据库等耳熟能详的基础课。
在这些众多的课程当中，我觉得有以下几门课程是较为重要的，
作为一个OS人，也许适当地复习这几门课程会很有好处：

**编程语言，主要是C语言**。目前的操作系统一般由C语言开发，相关的底层软件也广泛采用C语言。
掌握C语言应该是每个OS人的第一项必备技能。
学习C语言的正确姿势应该是拒绝使用封面印有“谭浩强”的所有书籍。
诸如[C Programming Language][6]这样的教材可以作为首选。

**算法与数据结构**。操作系统中可能用不到诸如动态规划这样的高级算法，
但基础的链表、树结构及其相应遍历、增删改查算法还是很有必要掌握的。
学习数据结构与算法我首推[算法 第四版][1]，即红色封面的那本书。
读书的同时，网站leetcode应该能有效地帮助你检验你的学习成果。
此外，如果你很快就要参加面试了，还可以用[剑指offer][3]和[编程之美][2]这样的书来抱一下佛脚。

**计算机网络**。操作系统与网络总是密不可分，大量的OS方面的最新研究成果都与网络有关。
个人认为[计算机网络 谢希仁][4]是一本良心的国产教材，对于初学者应该非常够用，配合其习题辅导书的话应该会更好。

**计算机体系结构**。同样是计算机科学的必修课，但这对于底层软件开发者来说更重要一些。
学会至少一种CPU的指令集、寄存器集和汇编基本用法是基本功，
此外，理解CPU的架构和工作模式对于日后的细微的性能调优工作可能有很大的帮助。

**计算机系统入门**。是时候整合一下你的基础知识，来从更大的视角理解计算机系统了。
这里祭出系统软件入门的神书——[CSAPP][7]，书名全称*Computer Systems: A Programmer's Perspective*，
中文译名叫做《深入理解计算机系统》，最新版是第三版。
即使你未来不做操作系统，我想这本书也很值得一读。

**操作系统**。学习基础知识阶段，应该以理解概念和适当的实验为主。
据我所知，目前最新的操作系统教材是2015年的[Modern Operating Systems, 4ed][8]。
这可能是本科阶段的最晦涩的一本书。
对于一个OS人来说，通读一本这样的书并对OS的各个方面有一个基本认识应该是非常必要的。

其他课程，诸如编译原理等，本着技多不压身的原则也不能说扔就扔，
但这里只讨论必要技能，所以就不再赘述了。

### 进阶

作为一个OS人，掌握更多更专业的知识和技能应该是必要的，
这也是每个OS人的终身奋斗的目标。

**高级操作系统实验**。OS人不能只玩过基本的shell实验，还要试着通过更高级的实验
去看看内核中有什么。我中意的实验课是[MIT 6.828][9]，从写一个shell开始，
逐渐演变为以填补漏洞的形式学习内核各个部分的代码。

**Linux深入学习**。Linux的源代码是深入学习操作系统的不二选择。
有三本神书可以帮助学习Linux。第一本是Rebert Love的[Linux Kernel Development][10]，简称LKD。
这本书以Linux内核的概念和数据结构为主，并不会大幅地罗列代码，比较适合入门。
另外两本是[Understanding the Linux Kernel][11]，简称ULK，和[Linux Device Drivers][12]，简称LDD。

**虚拟化与容器**。现代操作系统往往扮演hypervisor的角色，学习虚拟化应该是有必要的。
英特尔开源技术中心的[系统虚拟化：原理与实现][5]比较好地介绍了虚拟化的相关知识，
适合作为入门书籍学习。此外，以docker为代表的的容器技术应该需要适当掌握。

**Unikernel等前沿技术**。Unikernel是现在云环境下一种新型的操作系统架构，
虽然其发展还不够成熟，但不失为未来的一种趋势。

## 最后的话

作为一个OS人，我的学生时代虽然已经过去，但职业生涯才刚刚开始。在后面的日子里，边做边学将是必不可少的。
一方面要锤炼扎实的编程功底，还要开拓眼界，学习工业界和学术界的系统软件最新的进展。
我计划在10月底赴上海参加SOSP的现场会议，感受一下与顶级OS大牛们同堂的气氛，也给自己加把劲。


[1]:    http://algs4.cs.princeton.edu/home/  "算法 第四版"
[2]:    http://item.jd.com/10066736.html "编程之美"
[3]:    http://item.jd.com/11483967.html "剑指offer"
[4]:    http://item.jd.com/11253933.html "计算机网络"
[5]:    http://baike.baidu.com "系统虚拟化"
[6]:    https://book.douban.com/subject/1236999/ 'C Programming Language'
[7]:    http://csapp.cs.cmu.edu/ 'CSAPP'
[8]:    https://www.amazon.com/Modern-Operating-Systems-Andrew-Tanenbaum/dp/013359162X/ref=sr_1_1?ie=UTF8&qid=1487074667&sr=8-1&keywords=modern+operating+systems 'Modern Operating Systems'
[9]:    https://pdos.csail.mit.edu/6.828/2016/schedule.html 'MIT 6.828'
[10]:   https://www.amazon.com/Linux-Kernel-Development-Robert-Love/dp/0672329468 'Linux Kernel Development'
[11]:   https://www.amazon.com/Understanding-Linux-Kernel-Third-Daniel/dp/0596005652 'Understanding the Linux Kernel'
[12]:   https://lwn.net/Kernel/LDD3/ 'Linux Device Drivers'
